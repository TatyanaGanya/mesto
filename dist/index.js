(()=>{"use strict";class e{constructor(e,t,s){this._card=e,this._link=e.image,this._name=e.title,this._elementTemplate=t,this._handleCardClick=s}_getTemplateClone(){return document.querySelector(".template").content.querySelector(".card").cloneNode(!0)}_putCardLike=()=>{this._likeElement.classList.toggle("card__like_active")};_deleteCard=()=>{this._cloneElement.remove(),this._cloneElement=null};_handeleOpenZoomImage=()=>{this._handleCardClick(this._card)};_setEventListener(){this._likeElement.addEventListener("click",this._putCardLike),this._deletaElement.addEventListener("click",this._deleteCard),this._imageElement.addEventListener("click",this._handeleOpenZoomImage)}createCard(){return this._cloneElement=this._getTemplateClone(),this._imageElement=this._cloneElement.querySelector(".card__image"),this._textElement=this._cloneElement.querySelector(".card__text"),this._likeElement=this._cloneElement.querySelector(".card__like"),this._deletaElement=this._cloneElement.querySelector(".card__delete"),this._imageElement.src=this._link,this._imageElement.alt=this._name,this._textElement.textContent=this._name,this._setEventListener(),this._cloneElement}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._form=t,this._button=t.querySelector(this._submitButtonSelector),this._inputList=t.querySelectorAll(this._inputSelector)}_hideErrorMessage(e,t){t.textContent="",e.classList.remove(this._inputErrorClass)}_showErrorMessage(e,t){t.textContent=e.validationMessage,e.classList.add(this._inputErrorClass)}_checkInputValidity(e){const t=document.querySelector(`#${e.id}-error`);e.checkValidity()?this._hideErrorMessage(e,t):this._showErrorMessage(e,t)}_enableButton(){this._button.classList.remove(this._inactiveButtonClass),this._button.removeAttribute("disabled")}_disableButton(){this._button.classList.add(this._inactiveButtonClass),this._button.setAttribute("disabled",!0)}_hasInvalidInput(){return Array.from(this._inputList).some((e=>!e.validity.valid))}_toggleButton(){this._hasInvalidInput(),this._hasInvalidInput()?this._disableButton():this._enableButton()}_setEventListner(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))}enableValidation(){this._setEventListner()}resetErrorOpenForm(){this._inputList.forEach((e=>{const t=this._form.querySelector(`#${e.id}-error`);e.validity.valid||this._hideErrorMessage(t,e)})),this._disableButton()}}class s{constructor(e){this._popup=document.querySelector(e),this._popupCloseButton=this._popup.querySelector(".popup__close")}_handleCloseEsc=e=>{"Escape"===e.key&&this.close()};_handleCloseButton=()=>{this.close()};_handleClickOnOverlay=e=>{e.target===e.currentTarget&&this.close()};setEvenListners(){this._popupCloseButton.addEventListener("click",this._handleCloseButton),this._popup.addEventListener("click",this._handleClickOnOverlay)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleCloseEsc)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleCloseEsc)}}class i extends s{constructor(e,t){super(e),this._submitFunction=t,this._form=this._popup.querySelector(".popup__content"),this._inputList=this._form.querySelectorAll(".popup__input")}_getIputValue(){return this._values={},this._inputList.forEach((e=>{this._values[e.name]=e.value})),this._values}setIputValue(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEvenListners(){super.setEvenListners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitFunction(this._getIputValue())}))}close(){super.close(),this._form.reset()}}const o=document.querySelector(".profile__edit"),r=document.querySelector(".profile__add"),n=document.forms.profile_form,l=document.forms.profile_title,a={formSelector:".popup__content",inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_invalid",inputErrorClass:"popup__input_error",errorClass:"popup__error"},p=new class extends s{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__image"),this._popupDescription=this._popup.querySelector(".popup__description")}open=e=>{this._popupImage.src=e.image,this._popupImage.alt=e.title,this._popupDescription.textContent=e.title,super.open()}}(".popup_zoom-image");p.setEvenListners();const _=new class{constructor({items:e,renderer:t},s){this._container=document.querySelector(s),this._items=e,this._renderer=t}addCardFromArray(){this._items.forEach((e=>{this.addItem(e)}))}addItem(e){this._container.prepend(this._renderer(e))}}({items:[{title:"Вечер",image:"https://images.unsplash.com/photo-1551582045-6ec9c11d8697"},{title:"Енот",image:"https://images.unsplash.com/photo-1655208479058-4991ca8af84a"},{title:"Котик",image:"https://img.fonwall.ru/o/53/kot-belyiy-vzglyad-glaza.jpg"},{title:"Cобачка",image:"https://cdnn1.inosmi.ru/img/24985/10/249851004_0:196:2030:1211_1280x0_80_0_0_87d6869bd94c383de3e0573302893762.jpg.webp"},{title:"ля-ля-ля",image:"https://icdn.lenta.ru/images/2014/10/22/12/20141022121419489/detail_a210512d2dc372a700ff8ab8676bc4fc.jpg"},{title:"Собака",image:"https://images.unsplash.com/photo-1610243684348-dc537f6067ca"}],renderer:t=>new e(t,".template",p.open).createCard()},".cards");_.addCardFromArray();const c=new class{constructor(e){this._profileName=document.querySelector(e.profileNameSelector),this._profileJob=document.querySelector(e.profileJobSelector)}getUserInfo(){return{profile_name:this._profileName.textContent,profile_job:this._profileJob.textContent}}setUserInfo(e){this._profileName.textContent=e.profile_name,this._profileJob.textContent=e.profile_job}}({profileNameSelector:".profile__name",profileJobSelector:".profile__about"}),u=new i(".popup_profile",(e=>{c.setUserInfo(e),u.close()}));o.addEventListener("click",(()=>{u.setIputValue(c.getUserInfo()),d.resetErrorOpenForm(),u.open()})),u.setEvenListners();const h=new i(".popup_galery",(e=>{_.addItem(e),h.close(),m.resetErrorOpenForm()}));h.setEvenListners(),r.addEventListener("click",(()=>h.open()));const d=new t(a,n);d.enableValidation();const m=new t(a,l);m.enableValidation()})();